<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<style>
  button {
    background-color: white;
  }
</style>

<script>
  let clicks = [];
  let user_clicks = [];
  let iteration = 0;
  let score = 3;
  let count_user_clicks = 0;
  let good_ans = 0;

  // variables for show sequence //
  let timer = 2000;
  let time_to_finish = 0;
  let isShowingSequence = 0;

  function rand() {
    for (i = 0; i < 1; i++) {
      let rand = Math.floor((Math.random() * 4) + 1) //random number 1/4
      clicks.push(rand)
    }
  }

  function showval(i) {
    document.getElementById(clicks[i]).style = "background-color:blue;";
  }

  function hideval(i) {
    document.getElementById(clicks[i]).style = "background-color:white;";
  }

  function check_user_inputs(current_click) {
    // user_clicks.push(0)

    console.log(count_user_clicks)

    if (clicks[count_user_clicks] == current_click) {
      console.log("good!")
      good_ans++
    } else {
      console.log("bad! Start again from the begining of a sequence")
      count_user_clicks = -1
      good_ans = 0;
      showSequence();
    }

    count_user_clicks++
    if (clicks.length == good_ans) {
      console.log('correct sequence!')
      count_user_clicks = 0;
      good_ans = 0;
      score++;
      game();
    }
  }

  function showSequence() {

    if (isShowingSequence == 0) { //is this sequence already showing ?
      isShowingSequence = 1;
      console.log(isShowingSequence)
      for (let i = 0; clicks.length > i; i++) {
        timer = (i + 1) * 2000;
        showvalTimer = window.setTimeout(function() {
          showval(i)
        }, timer + 2000)
        hidevalTimer = window.setTimeout(function() {
          hideval(i)
        }, timer + 500 + 2000)
        if (i == clicks.length - 1) {
          window.setTimeout(function() {
            console.log('sequence finished', timer)
            isShowingSequence = 0;
          }, timer + 500 + 2000)
        }
      }
    }
  }

  // main function game
  function game() {
    rand()
    console.log(clicks)
    showSequence();
  }

  /* buttons one two three four */

  function one() {
    check_user_inputs(1);
  }

  function two() {
    check_user_inputs(2);
  }

  function three() {
    check_user_inputs(3);
  }

  function four() {
    check_user_inputs(4);
  }
</script>

<body onload='game()'>
  <button id='1' onclick="one()">One</button>
  <button id='2' onclick="two()">Two</button>
  <button id='3' onclick="three()">Three</button>
  <button id='4' onclick="four()">Four</button>
</body>





</html>